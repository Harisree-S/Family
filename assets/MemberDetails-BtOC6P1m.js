import{u as F,b as M,j as e,m as r}from"./framer-motion-CfqgSJVN.js";import{d as L,r as l,L as H}from"./react-vendor-CC-NPt3m.js";import{I as N,C as R,a as W,M as k,s as d}from"./Toast-DWlkKtCC.js";import{u as G,P as $,g as Y,a as q,b as J,c as K,d as Q,e as X,o as Z,f as _,h as ee,s as ie}from"./index-DfT3VI1S.js";import{A as te,I as O,P as T}from"./ui-vendor-DsSFL4s6.js";const P={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.3}}},D={hidden:{y:30,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:50}}},me=()=>{const{id:oe}=L(),[n,p]=l.useState(null),[B,f]=l.useState([]),{playImageAudio:g,playSfx:V,clearImageAudio:y,setIsVideoPlaying:u}=G(),[ae,ne]=l.useState(!1),{scrollY:h}=F(),z=M(h,[0,300],[0,150]),A=M(h,[0,300],[1,.5]),c=()=>{member&&Y(member.id,"member").then(i=>{const t=i.filter(s=>s.type==="image"),a=i.filter(s=>s.type==="video");f(t),setUploadedVideos(a)}).catch(console.error),setHiddenMedia(q()),setCaptionOverrides(J()),member&&K(member.id,"member").then(i=>{i?(setProfileImage(i.url),setProfileStyle({objectPosition:i.position,transform:`scale(${i.scale})`})):(setProfileImage(member.photo),setProfileStyle({objectPosition:member.imagePosition||"50% 20%"}))})};l.useEffect(()=>{c()},[member]);const[m,x]=l.useState(null);l.useEffect(()=>(member&&member.entryAudio&&g(member.entryAudio,member.audioVolume||.5,!0),()=>{y()}),[member,g,y]);const b=i=>{x(i),Z(async t=>{try{if(i!=="cover"){const a=await ie(member.id,"member",t.type,t.url,t.storagePath);t.type==="video"?setUploadedVideos(s=>[...s,a]):f(s=>[...s,a]),d("Uploaded successfully!","success"),setEditingItem(a),setIsCaptionModalOpen(!0),c()}}catch(a){console.error("Save failed:",a),d(`Save failed: ${a.message}`,"error")}finally{x(null)}})},v=(i,t)=>{p({...i,type:t}),i.audio&&V(i.audio),t==="video"&&u(!0)},E=()=>{p(null),u(!1)},j=(i,t)=>{setConfirmModal({isOpen:!0,title:"Delete Item",message:"Are you sure you want to delete this item? This action cannot be undone.",isDangerous:!0,onConfirm:async()=>{try{t.id?await _(t.id):ee(t.url),c(),d("Item deleted successfully","success")}catch(a){console.error("Delete failed:",a),d("Failed to delete item","error")}setConfirmModal(a=>({...a,isOpen:!1}))}})},C=(i,t)=>{setEditingItem(t),setIsCaptionModalOpen(!0)},U=async i=>{if(editingItem)try{editingItem.id?await Q(editingItem.id,{caption:i}):X(editingItem.url,i),c(),d("Caption updated successfully","success")}catch(t){console.error("Update failed:",t),d("Failed to update caption","error")}};if(!member)return e.jsx("div",{style:{color:"white",textAlign:"center",marginTop:"5rem"},children:"Member not found"});const I=i=>i.filter(t=>!hiddenMedia.includes(t.url)).map(t=>({...t,caption:captionOverrides[t.url]||t.caption})),w=[...I(member.photos||[]),...B],S=[...I(member.videos||[]),...uploadedVideos];return e.jsx($,{children:e.jsxs("div",{style:o.page,children:[e.jsx(N,{isOpen:!!n,mediaSrc:n==null?void 0:n.url,type:n==null?void 0:n.type,caption:n==null?void 0:n.caption,onClose:E}),e.jsx(R,{isOpen:isCaptionModalOpen,onClose:()=>setIsCaptionModalOpen(!1),onSave:U,initialCaption:editingItem==null?void 0:editingItem.caption,title:"Edit Caption"}),e.jsx(W,{isOpen:confirmModal.isOpen,title:confirmModal.title,message:confirmModal.message,onConfirm:confirmModal.onConfirm,onCancel:()=>setConfirmModal(i=>({...i,isOpen:!1})),isDangerous:confirmModal.isDangerous,confirmText:"Delete"}),e.jsxs("div",{className:"container",children:[e.jsxs(H,{to:"/",style:o.backLink,children:[e.jsx(te,{size:24})," ",e.jsx("span",{style:{marginLeft:"0.5rem"},children:"Back to Family"})]}),e.jsxs("div",{style:o.header,children:[e.jsx(r.div,{style:{...o.profileSection,y:z,opacity:A},children:e.jsxs("div",{style:o.profileImageWrapper,children:[e.jsx("img",{src:profileImage||member.photo,alt:member.name,style:{...o.profileImage,...profileStyle}}),e.jsx("div",{style:o.profileGlow})]})}),e.jsxs(r.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.8},style:o.infoCard,className:"glass-panel",children:[e.jsx("h1",{style:o.name,children:member.name}),e.jsx("h3",{style:o.relation,children:member.relation}),e.jsx("div",{style:o.divider}),e.jsx("p",{style:o.bio,children:member.bio}),e.jsxs("div",{style:o.actionButtons,children:[e.jsxs("button",{onClick:()=>b("image"),style:o.actionBtn,disabled:m!==null,children:[m==="image"?e.jsx("span",{className:"loader",style:{width:16,height:16,border:"2px solid #d4af37",borderBottomColor:"transparent",borderRadius:"50%",display:"inline-block",animation:"rotation 1s linear infinite"}}):e.jsx(O,{size:18}),e.jsx("span",{style:{marginLeft:"0.5rem"},children:"ADD PHOTO"})]}),e.jsxs("button",{onClick:()=>b("video"),style:o.actionBtn,disabled:m!==null,children:[m==="video"?e.jsx("span",{className:"loader",style:{width:16,height:16,border:"2px solid #d4af37",borderBottomColor:"transparent",borderRadius:"50%",display:"inline-block",animation:"rotation 1s linear infinite"}}):e.jsx(T,{size:18}),e.jsx("span",{style:{marginLeft:"0.5rem"},children:"ADD VIDEO"})]})]})]})]}),e.jsxs(r.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},style:o.section,children:[e.jsxs("h2",{style:o.sectionTitle,children:[e.jsx("span",{style:o.titleIcon,children:e.jsx(O,{size:24})}),"Captured Moments"]}),e.jsx(r.div,{variants:P,initial:"hidden",whileInView:"visible",viewport:{once:!0},style:o.grid,children:w.length>0?w.map((i,t)=>e.jsx(r.div,{variants:D,children:e.jsx(k,{item:i,type:"image",onClick:a=>v(a,"image"),onEdit:C,onDelete:j})},t)):e.jsx("p",{style:o.emptyText,children:"No photos yet."})})]}),e.jsxs(r.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},style:o.section,children:[e.jsxs("h2",{style:o.sectionTitle,children:[e.jsx("span",{style:o.titleIcon,children:e.jsx(T,{size:24})}),"Video Memories"]}),e.jsx(r.div,{variants:P,initial:"hidden",whileInView:"visible",viewport:{once:!0},style:o.grid,children:S.length>0?S.map((i,t)=>e.jsx(r.div,{variants:D,children:e.jsx(k,{item:i,type:"video",onClick:a=>v(a,"video"),onEdit:C,onDelete:j})},t)):e.jsx("p",{style:o.emptyText,children:"No videos yet."})})]})]})]})})},o={page:{minHeight:"100vh",backgroundColor:"#030305",color:"#fff",padding:"2rem 0",backgroundImage:"radial-gradient(circle at 50% 0%, #1a1a1a 0%, #030305 70%)"},backLink:{display:"inline-flex",alignItems:"center",color:"#d4af37",textDecoration:"none",marginBottom:"3rem",fontSize:"1rem",textTransform:"uppercase",letterSpacing:"0.1em",opacity:.8,transition:"opacity 0.3s"},header:{display:"flex",flexDirection:"column",alignItems:"center",gap:"3rem",marginBottom:"6rem",position:"relative"},profileSection:{position:"relative",zIndex:1},profileImageWrapper:{width:"clamp(200px, 40vw, 300px)",height:"clamp(200px, 40vw, 300px)",borderRadius:"50%",overflow:"hidden",border:"1px solid rgba(212, 175, 55, 0.3)",boxShadow:"0 0 50px rgba(212, 175, 55, 0.15)",position:"relative"},profileImage:{width:"100%",height:"100%",objectFit:"cover",filter:"contrast(1.1) saturate(1.1)"},profileGlow:{position:"absolute",inset:0,background:"radial-gradient(circle at center, transparent 50%, rgba(212, 175, 55, 0.2) 100%)",pointerEvents:"none"},infoCard:{maxWidth:"800px",width:"100%",padding:"3rem",borderRadius:"30px",textAlign:"center",marginTop:"-50px",zIndex:2},name:{fontSize:"clamp(2.5rem, 6vw, 4rem)",fontFamily:"'Cormorant Garamond', serif",color:"#fff",marginBottom:"0.5rem",textShadow:"0 0 30px rgba(255,255,255,0.1)"},relation:{fontSize:"1.2rem",color:"#d4af37",fontFamily:"'Outfit', sans-serif",textTransform:"uppercase",letterSpacing:"0.2em",marginBottom:"2rem"},divider:{width:"60px",height:"1px",background:"linear-gradient(90deg, transparent, #d4af37, transparent)",margin:"0 auto 2rem"},bio:{fontSize:"1.2rem",lineHeight:"1.8",color:"#ccc",fontFamily:"'Outfit', sans-serif",fontWeight:300,marginBottom:"2.5rem"},actionButtons:{display:"flex",gap:"1.5rem",justifyContent:"center",flexWrap:"wrap"},actionBtn:{display:"flex",alignItems:"center",gap:"0.8rem",padding:"0.8rem 2rem",backgroundColor:"rgba(212, 175, 55, 0.1)",border:"1px solid rgba(212, 175, 55, 0.3)",borderRadius:"50px",color:"#d4af37",cursor:"pointer",fontSize:"0.9rem",textTransform:"uppercase",letterSpacing:"0.1em",transition:"all 0.3s ease"},section:{marginBottom:"6rem"},sectionTitle:{fontSize:"2.5rem",fontFamily:"'Cormorant Garamond', serif",marginBottom:"3rem",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem"},titleIcon:{color:"#d4af37",display:"flex"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"2rem"},emptyText:{color:"#666",fontStyle:"italic",textAlign:"center",gridColumn:"1 / -1",padding:"2rem"}};export{me as default};
