import{u as ie,b as E,j as e,m as l}from"./framer-motion-CfqgSJVN.js";import{d as oe,r as n,L as ae}from"./react-vendor-CC-NPt3m.js";import{f as se,u as ne,P as re,g as le,a as de,b as ce,c as pe,d as me,e as fe,o as ue,h as ge,i as he,s as ye,j as xe}from"./index-D-VKtFms.js";import{I as ve,C as be,a as je,M as U,s as p}from"./Toast-BdVvhAcQ.js";import{A as Ce,I as b,P as F}from"./ui-vendor-DsSFL4s6.js";const H={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.3}}},L={hidden:{y:30,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:50}}},ke=()=>{const{id:W}=oe(),[r,j]=n.useState(null),[R,C]=n.useState([]),[G,S]=n.useState([]),[N,$]=n.useState([]),[Y,q]=n.useState({}),[J,g]=n.useState(null),[K,h]=n.useState({}),[Q,y]=n.useState(!1),[d,w]=n.useState(null),[m,x]=n.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},isDangerous:!1}),a=se.find(i=>i.id===parseInt(W)),{playImageAudio:I,playSfx:X,clearImageAudio:M,setIsVideoPlaying:P}=ne(),[f,k]=n.useState(!1),{scrollY:O}=ie(),Z=E(O,[0,300],[0,150]),_=E(O,[0,300],[1,.5]),u=()=>{a&&le(a.id,"member").then(i=>{const t=i.filter(c=>c.type==="image"),s=i.filter(c=>c.type==="video");C(t),S(s)}).catch(console.error),$(de()),q(ce()),a&&pe(a.id,"member").then(i=>{i?(g(i.url),h({objectPosition:i.position,transform:`scale(${i.scale})`})):(g(a.photo),h({objectPosition:a.imagePosition||"50% 20%"}))})};n.useEffect(()=>{u()},[a]),n.useEffect(()=>(a&&a.entryAudio&&I(a.entryAudio,a.audioVolume||.5,!0),()=>{M()}),[a,I,M]);const v=i=>{ue(async t=>{k(!0);try{if(i==="cover"){const s=await ye(a.id,"member",t.url,t.storagePath);g(s.url),h({objectPosition:s.position,transform:`scale(${s.scale})`}),p("Profile photo updated!","success")}else{const s=await xe(a.id,"member",t.type,t.url,t.storagePath);t.type==="video"?S(c=>[...c,s]):C(c=>[...c,s]),p("Uploaded successfully!","success"),w(s),y(!0),u()}}catch(s){console.error("Save failed:",s),p(`Save failed: ${s.message}`,"error")}finally{k(!1)}})},T=(i,t)=>{j({...i,type:t}),i.audio&&X(i.audio),t==="video"&&P(!0)},ee=()=>{j(null),P(!1)},z=(i,t)=>{x({isOpen:!0,title:"Delete Item",message:"Are you sure you want to delete this item? This action cannot be undone.",isDangerous:!0,onConfirm:async()=>{try{t.id?await ge(t.id):he(t.url),u(),p("Item deleted successfully","success")}catch(s){console.error("Delete failed:",s),p("Failed to delete item","error")}x(s=>({...s,isOpen:!1}))}})},B=(i,t)=>{w(t),y(!0)},te=async i=>{if(d)try{d.id?await me(d.id,{caption:i}):fe(d.url,i),u(),p("Caption updated successfully","success")}catch(t){console.error("Update failed:",t),p("Failed to update caption","error")}};if(!a)return e.jsx("div",{style:{color:"white",textAlign:"center",marginTop:"5rem"},children:"Member not found"});const A=i=>i.filter(t=>!N.includes(t.url)).map(t=>({...t,caption:Y[t.url]||t.caption})),D=[...A(a.photos||[]),...R],V=[...A(a.videos||[]),...G];return e.jsx(re,{children:e.jsxs("div",{style:o.page,children:[e.jsx(ve,{isOpen:!!r,mediaSrc:r==null?void 0:r.url,type:r==null?void 0:r.type,caption:r==null?void 0:r.caption,onClose:ee}),e.jsx(be,{isOpen:Q,onClose:()=>y(!1),onSave:te,initialCaption:d==null?void 0:d.caption,title:"Edit Caption"}),e.jsx(je,{isOpen:m.isOpen,title:m.title,message:m.message,onConfirm:m.onConfirm,onCancel:()=>x(i=>({...i,isOpen:!1})),isDangerous:m.isDangerous,confirmText:"Delete"}),e.jsxs("div",{className:"container",children:[e.jsxs(ae,{to:"/",style:o.backLink,children:[e.jsx(Ce,{size:24})," ",e.jsx("span",{style:{marginLeft:"0.5rem"},children:"Back to Family"})]}),e.jsxs("div",{style:o.header,children:[e.jsx(l.div,{style:{...o.profileSection,y:Z,opacity:_},children:e.jsxs("div",{style:o.profileImageWrapper,children:[e.jsx("img",{src:J||a.photo,alt:a.name,style:{...o.profileImage,...K}}),e.jsx("div",{style:o.profileGlow}),e.jsx("button",{onClick:()=>v("cover"),style:o.editCoverBtn,title:"Change Profile Photo",children:e.jsx(b,{size:16})})]})}),e.jsxs(l.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.8},style:o.infoCard,className:"glass-panel",children:[e.jsx("h1",{style:o.name,children:a.name}),e.jsx("h3",{style:o.relation,children:a.relation}),e.jsx("div",{style:o.divider}),e.jsx("p",{style:o.bio,children:a.bio}),e.jsxs("div",{style:o.actionButtons,children:[e.jsxs("button",{onClick:()=>v("image"),style:o.actionBtn,disabled:f,children:[e.jsx(b,{size:18})," ",f?"Uploading...":"Add Photo"]}),e.jsxs("button",{onClick:()=>v("video"),style:o.actionBtn,disabled:f,children:[e.jsx(F,{size:18})," ",f?"Uploading...":"Add Video"]})]})]})]}),e.jsxs(l.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},style:o.section,children:[e.jsxs("h2",{style:o.sectionTitle,children:[e.jsx("span",{style:o.titleIcon,children:e.jsx(b,{size:24})}),"Captured Moments"]}),e.jsx(l.div,{variants:H,initial:"hidden",whileInView:"visible",viewport:{once:!0},style:o.grid,children:D.length>0?D.map((i,t)=>e.jsx(l.div,{variants:L,children:e.jsx(U,{item:i,type:"image",onClick:s=>T(s,"image"),onEdit:B,onDelete:z})},t)):e.jsx("p",{style:o.emptyText,children:"No photos yet."})})]}),e.jsxs(l.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},style:o.section,children:[e.jsxs("h2",{style:o.sectionTitle,children:[e.jsx("span",{style:o.titleIcon,children:e.jsx(F,{size:24})}),"Video Memories"]}),e.jsx(l.div,{variants:H,initial:"hidden",whileInView:"visible",viewport:{once:!0},style:o.grid,children:V.length>0?V.map((i,t)=>e.jsx(l.div,{variants:L,children:e.jsx(U,{item:i,type:"video",onClick:s=>T(s,"video"),onEdit:B,onDelete:z})},t)):e.jsx("p",{style:o.emptyText,children:"No videos yet."})})]})]})]})})},o={page:{minHeight:"100vh",backgroundColor:"#030305",color:"#fff",padding:"2rem 0",backgroundImage:"radial-gradient(circle at 50% 0%, #1a1a1a 0%, #030305 70%)"},backLink:{display:"inline-flex",alignItems:"center",color:"#d4af37",textDecoration:"none",marginBottom:"3rem",fontSize:"1rem",textTransform:"uppercase",letterSpacing:"0.1em",opacity:.8,transition:"opacity 0.3s"},header:{display:"flex",flexDirection:"column",alignItems:"center",gap:"3rem",marginBottom:"6rem",position:"relative"},profileSection:{position:"relative",zIndex:1},profileImageWrapper:{width:"clamp(200px, 40vw, 300px)",height:"clamp(200px, 40vw, 300px)",borderRadius:"50%",overflow:"hidden",border:"1px solid rgba(212, 175, 55, 0.3)",boxShadow:"0 0 50px rgba(212, 175, 55, 0.15)",position:"relative"},profileImage:{width:"100%",height:"100%",objectFit:"cover",filter:"contrast(1.1) saturate(1.1)"},profileGlow:{position:"absolute",inset:0,background:"radial-gradient(circle at center, transparent 50%, rgba(212, 175, 55, 0.2) 100%)",pointerEvents:"none"},editCoverBtn:{position:"absolute",bottom:"20px",right:"20px",width:"40px",height:"40px",borderRadius:"50%",backgroundColor:"rgba(0,0,0,0.8)",border:"1px solid #d4af37",color:"#d4af37",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:10,transition:"transform 0.2s"},infoCard:{maxWidth:"800px",width:"100%",padding:"3rem",borderRadius:"30px",textAlign:"center",marginTop:"-50px",zIndex:2},name:{fontSize:"clamp(2.5rem, 6vw, 4rem)",fontFamily:"'Cormorant Garamond', serif",color:"#fff",marginBottom:"0.5rem",textShadow:"0 0 30px rgba(255,255,255,0.1)"},relation:{fontSize:"1.2rem",color:"#d4af37",fontFamily:"'Outfit', sans-serif",textTransform:"uppercase",letterSpacing:"0.2em",marginBottom:"2rem"},divider:{width:"60px",height:"1px",background:"linear-gradient(90deg, transparent, #d4af37, transparent)",margin:"0 auto 2rem"},bio:{fontSize:"1.2rem",lineHeight:"1.8",color:"#ccc",fontFamily:"'Outfit', sans-serif",fontWeight:300,marginBottom:"2.5rem"},actionButtons:{display:"flex",gap:"1.5rem",justifyContent:"center",flexWrap:"wrap"},actionBtn:{display:"flex",alignItems:"center",gap:"0.8rem",padding:"0.8rem 2rem",backgroundColor:"rgba(212, 175, 55, 0.1)",border:"1px solid rgba(212, 175, 55, 0.3)",borderRadius:"50px",color:"#d4af37",cursor:"pointer",fontSize:"0.9rem",textTransform:"uppercase",letterSpacing:"0.1em",transition:"all 0.3s ease"},section:{marginBottom:"6rem"},sectionTitle:{fontSize:"2.5rem",fontFamily:"'Cormorant Garamond', serif",marginBottom:"3rem",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem"},titleIcon:{color:"#d4af37",display:"flex"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"2rem"},emptyText:{color:"#666",fontStyle:"italic",textAlign:"center",gridColumn:"1 / -1",padding:"2rem"}};export{ke as default};
