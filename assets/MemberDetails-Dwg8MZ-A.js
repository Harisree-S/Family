import{u as ae,b as R,j as e,m as l}from"./framer-motion-CfqgSJVN.js";import{d as ne,r as n,L as re}from"./react-vendor-CC-NPt3m.js";import{f as le,u as de,s as ce,g as N,a as U,b as pe,P as me,c as fe,d as ue,o as ge,e as ye,h as he,i as xe}from"./index-EfNTdAbv.js";import{I as be,C as ve,a as je,M as W,s as c}from"./Toast-CTdET4DJ.js";import{A as Ce,I as G,P as $}from"./ui-vendor-DsSFL4s6.js";const Y={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.3}}},q={hidden:{y:30,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:50}}},De=()=>{const{id:J}=ne(),[r,x]=n.useState(null),[b,v]=n.useState([]),[j,C]=n.useState([]),[K,S]=n.useState([]),[Q,I]=n.useState({}),[X,w]=n.useState(null),[Z,M]=n.useState({}),[_,u]=n.useState(!1),[d,k]=n.useState(null),[p,g]=n.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},isDangerous:!1}),o=le.find(s=>s.id===parseInt(J)),{playImageAudio:T,playSfx:ee,clearImageAudio:D,setIsVideoPlaying:O}=de(),{scrollY:P}=ae(),ie=R(P,[0,300],[0,150]),te=R(P,[0,300],[1,.5]),[f,y]=n.useState(null),[Se,z]=n.useState(null);n.useEffect(()=>{if(!o)return;const s=ce(o.id,"member",i=>{const a=i.filter(h=>h.type==="image"),m=i.filter(h=>h.type==="video");v(a),C(m),z(null)},i=>{z(i.message)});return S(N()),I(U()),pe(o.id,"member").then(i=>{i?(w(i.url),M({objectPosition:i.position,transform:`scale(${i.scale})`})):(w(o.photo),M({objectPosition:o.imagePosition||"50% 20%"}))}),()=>s()},[o]),n.useEffect(()=>(o&&o.entryAudio&&T(o.entryAudio,o.audioVolume||.5,!0),()=>{D()}),[o,T,D]);const B=s=>{y(s),ge(async i=>{try{if(s!=="cover"){const a=await xe(o.id,"member",i.type,i.url,i.storagePath);i.type==="video"?C(m=>[...m,a]):v(m=>[...m,a]),c("Uploaded successfully!","success"),k(a),u(!0)}}catch(a){console.error("Save failed:",a),c(`Save failed: ${a.message}`,"error")}finally{y(null)}},()=>{y(null)})},E=(s,i)=>{x({...s,type:i}),s.audio&&ee(s.audio),i==="video"&&O(!0)},oe=()=>{x(null),O(!1)},V=(s,i)=>{g({isOpen:!0,title:"Delete Item",message:"Are you sure you want to delete this item? This action cannot be undone.",isDangerous:!0,onConfirm:async()=>{try{i.id?await ye(i.id):(he(i.url),S(N())),c("Item deleted successfully","success")}catch(a){console.error("Delete failed:",a),c("Failed to delete item","error")}g(a=>({...a,isOpen:!1}))}})},A=(s,i)=>{k(i),u(!0)},se=async s=>{if(d)try{d.id?await fe(d.id,{caption:s}):(ue(d.url,s),I(U())),c("Caption updated successfully","success")}catch(i){console.error("Update failed:",i),c("Failed to update caption","error")}};if(!o)return e.jsx("div",{style:{color:"white",textAlign:"center",marginTop:"5rem"},children:"Member not found"});const F=s=>s.filter(i=>!K.includes(i.url)).map(i=>({...i,caption:Q[i.url]||i.caption})),L=[...F(o.photos||[]),...b],H=[...F(o.videos||[]),...j];return e.jsxs(me,{children:[e.jsxs("div",{style:t.page,children:[e.jsx(be,{isOpen:!!r,mediaSrc:r==null?void 0:r.url,type:r==null?void 0:r.type,caption:r==null?void 0:r.caption,onClose:oe}),e.jsx(ve,{isOpen:_,onClose:()=>u(!1),onSave:se,initialCaption:d==null?void 0:d.caption,title:"Edit Caption"}),e.jsx(je,{isOpen:p.isOpen,title:p.title,message:p.message,onConfirm:p.onConfirm,onCancel:()=>g(s=>({...s,isOpen:!1})),isDangerous:p.isDangerous,confirmText:"Delete"}),e.jsxs("div",{className:"container",children:[e.jsxs(re,{to:"/",style:t.backLink,children:[e.jsx(Ce,{size:24})," ",e.jsx("span",{style:{marginLeft:"0.5rem"},children:"Back to Family"})]}),e.jsxs("div",{style:t.header,children:[e.jsx(l.div,{style:{...t.profileSection,y:ie,opacity:te},children:e.jsxs("div",{style:t.profileImageWrapper,children:[e.jsx("img",{src:X||o.photo,alt:o.name,style:{...t.profileImage,...Z}}),e.jsx("div",{style:t.profileGlow})]})}),e.jsxs(l.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.8},style:t.infoCard,className:"glass-panel",children:[e.jsx("h1",{style:t.name,children:o.name}),e.jsx("h3",{style:t.relation,children:o.relation}),e.jsx("div",{style:t.divider}),e.jsx("p",{style:t.bio,children:o.bio}),e.jsxs("div",{style:t.actionButtons,children:[e.jsxs("button",{onClick:()=>B("image"),style:t.actionBtn,disabled:f!==null,children:[f==="image"?e.jsx("span",{className:"loader",style:{width:16,height:16,border:"2px solid #d4af37",borderBottomColor:"transparent",borderRadius:"50%",display:"inline-block",animation:"rotation 1s linear infinite"}}):e.jsx(G,{size:18}),e.jsx("span",{style:{marginLeft:"0.5rem"},children:"ADD PHOTO"})]}),e.jsxs("button",{onClick:()=>B("video"),style:t.actionBtn,disabled:f!==null,children:[f==="video"?e.jsx("span",{className:"loader",style:{width:16,height:16,border:"2px solid #d4af37",borderBottomColor:"transparent",borderRadius:"50%",display:"inline-block",animation:"rotation 1s linear infinite"}}):e.jsx($,{size:18}),e.jsx("span",{style:{marginLeft:"0.5rem"},children:"ADD VIDEO"})]})]})]})]}),e.jsxs(l.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},style:t.section,children:[e.jsxs("h2",{style:t.sectionTitle,children:[e.jsx("span",{style:t.titleIcon,children:e.jsx(G,{size:24})}),"Captured Moments"]}),e.jsx(l.div,{variants:Y,initial:"hidden",whileInView:"visible",viewport:{once:!0},style:t.grid,children:L.length>0?L.map((s,i)=>e.jsx(l.div,{variants:q,children:e.jsx(W,{item:s,type:"image",onClick:a=>E(a,"image"),onEdit:A,onDelete:V})},i)):e.jsx("p",{style:t.emptyText,children:"No photos yet."})})]}),e.jsxs(l.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},style:t.section,children:[e.jsxs("h2",{style:t.sectionTitle,children:[e.jsx("span",{style:t.titleIcon,children:e.jsx($,{size:24})}),"Video Memories"]}),e.jsx(l.div,{variants:Y,initial:"hidden",whileInView:"visible",viewport:{once:!0},style:t.grid,children:H.length>0?H.map((s,i)=>e.jsx(l.div,{variants:q,children:e.jsx(W,{item:s,type:"video",onClick:a=>E(a,"video"),onEdit:A,onDelete:V})},i)):e.jsx("p",{style:t.emptyText,children:"No videos yet."})})]})]})]}),e.jsxs("div",{style:{position:"fixed",bottom:10,right:10,background:"rgba(0,0,0,0.8)",color:"#0f0",padding:"10px",borderRadius:"5px",fontSize:"12px",zIndex:9999,pointerEvents:"none"},children:[e.jsxs("p",{children:["Member ID: ",o==null?void 0:o.id]}),e.jsxs("p",{children:["Photos: ",b.length]}),e.jsxs("p",{children:["Videos: ",j.length]})]})]})},t={page:{minHeight:"100vh",backgroundColor:"#030305",color:"#fff",padding:"2rem 0",backgroundImage:"radial-gradient(circle at 50% 0%, #1a1a1a 0%, #030305 70%)"},backLink:{display:"inline-flex",alignItems:"center",color:"#d4af37",textDecoration:"none",marginBottom:"3rem",fontSize:"1rem",textTransform:"uppercase",letterSpacing:"0.1em",opacity:.8,transition:"opacity 0.3s"},header:{display:"flex",flexDirection:"column",alignItems:"center",gap:"3rem",marginBottom:"6rem",position:"relative"},profileSection:{position:"relative",zIndex:1},profileImageWrapper:{width:"clamp(200px, 40vw, 300px)",height:"clamp(200px, 40vw, 300px)",borderRadius:"50%",overflow:"hidden",border:"1px solid rgba(212, 175, 55, 0.3)",boxShadow:"0 0 50px rgba(212, 175, 55, 0.15)",position:"relative"},profileImage:{width:"100%",height:"100%",objectFit:"cover",filter:"contrast(1.1) saturate(1.1)"},profileGlow:{position:"absolute",inset:0,background:"radial-gradient(circle at center, transparent 50%, rgba(212, 175, 55, 0.2) 100%)",pointerEvents:"none"},infoCard:{maxWidth:"800px",width:"100%",padding:"3rem",borderRadius:"30px",textAlign:"center",marginTop:"-50px",zIndex:2},name:{fontSize:"clamp(2.5rem, 6vw, 4rem)",fontFamily:"'Cormorant Garamond', serif",color:"#fff",marginBottom:"0.5rem",textShadow:"0 0 30px rgba(255,255,255,0.1)"},relation:{fontSize:"1.2rem",color:"#d4af37",fontFamily:"'Outfit', sans-serif",textTransform:"uppercase",letterSpacing:"0.2em",marginBottom:"2rem"},divider:{width:"60px",height:"1px",background:"linear-gradient(90deg, transparent, #d4af37, transparent)",margin:"0 auto 2rem"},bio:{fontSize:"1.2rem",lineHeight:"1.8",color:"#ccc",fontFamily:"'Outfit', sans-serif",fontWeight:300,marginBottom:"2.5rem"},actionButtons:{display:"flex",gap:"1.5rem",justifyContent:"center",flexWrap:"wrap"},actionBtn:{display:"flex",alignItems:"center",gap:"0.8rem",padding:"0.8rem 2rem",backgroundColor:"rgba(212, 175, 55, 0.1)",border:"1px solid rgba(212, 175, 55, 0.3)",borderRadius:"50px",color:"#d4af37",cursor:"pointer",fontSize:"0.9rem",textTransform:"uppercase",letterSpacing:"0.1em",transition:"all 0.3s ease"},section:{marginBottom:"6rem"},sectionTitle:{fontSize:"2.5rem",fontFamily:"'Cormorant Garamond', serif",marginBottom:"3rem",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem"},titleIcon:{color:"#d4af37",display:"flex"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"2rem"},emptyText:{color:"#666",fontStyle:"italic",textAlign:"center",gridColumn:"1 / -1",padding:"2rem"}};export{De as default};
