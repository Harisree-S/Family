import{u as ne,b as U,j as e,m as l}from"./framer-motion-CfqgSJVN.js";import{d as re,r as n,L as le}from"./react-vendor-CC-NPt3m.js";import{m as de,u as ce,s as pe,g as F,a as N,b as me,P as ue,c as ye,d as ge,o as fe,e as he,h as xe,i as ve}from"./index-EfNTdAbv.js";import{I as je,C as be,a as Ce,M as G,s as c}from"./Toast-CTdET4DJ.js";import{A as Se,I as $,P as Y}from"./ui-vendor-DsSFL4s6.js";const q={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.3}}},J={hidden:{y:30,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:50}}},Oe=()=>{const{id:K}=re(),[r,x]=n.useState(null),[v,j]=n.useState([]),[b,C]=n.useState([]),[Q,S]=n.useState([]),[X,I]=n.useState({}),[Z,w]=n.useState(null),[_,M]=n.useState({}),[ee,y]=n.useState(!1),[d,k]=n.useState(null),[p,g]=n.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{},isDangerous:!1}),s=de.find(o=>o.id===parseInt(K)),{playImageAudio:D,playSfx:te,clearImageAudio:O,setIsVideoPlaying:T}=ce(),{scrollY:E}=ne(),ie=U(E,[0,500],[0,200]),oe=U(E,[0,400],[1,.3]);n.useEffect(()=>{if(!s)return;const o=pe(s.id,"memory",t=>{const a=t.filter(h=>h.type==="image"),m=t.filter(h=>h.type==="video");j(a),C(m),z(null)},t=>{z(t.message)});return S(F()),I(N()),me(s.id,"memory").then(t=>{t?(w(t.url),M({objectPosition:t.position,transform:`scale(${t.scale})`})):(w(s.cover),M({objectPosition:s.coverPosition||"center"}))}),()=>o()},[s]);const[u,f]=n.useState(null),[P,z]=n.useState(null);n.useEffect(()=>(s&&s.entryAudio&&D(s.entryAudio,s.audioVolume||.5,!0),()=>{O()}),[s,D,O]);const B=o=>{f(o),fe(async t=>{try{if(o!=="cover"){const a=await ve(s.id,"memory",t.type,t.url,t.storagePath);t.type==="video"?C(m=>[...m,a]):j(m=>[...m,a]),c("Uploaded successfully!","success"),k(a),y(!0)}}catch(a){console.error(a),c(`Upload failed: ${a.message}`,"error")}finally{f(null)}},()=>{f(null)})},V=(o,t)=>{x({...o,type:t}),o.audio&&te(o.audio),t==="video"&&T(!0)},se=()=>{x(null),T(!1)},A=(o,t)=>{g({isOpen:!0,title:"Delete Item",message:"Are you sure you want to delete this item? This action cannot be undone.",isDangerous:!0,onConfirm:async()=>{try{t.id?await he(t.id):(xe(t.url),S(F())),c("Item deleted successfully","success")}catch(a){console.error("Delete failed:",a),c("Failed to delete item","error")}g(a=>({...a,isOpen:!1}))}})},L=(o,t)=>{k(t),y(!0)},ae=async o=>{if(d)try{d.id?await ye(d.id,{caption:o}):(ge(d.url,o),I(N())),c("Caption updated successfully","success")}catch(t){console.error("Update failed:",t),c("Failed to update caption","error")}};if(!s)return e.jsx("div",{style:{color:"white",textAlign:"center",marginTop:"5rem"},children:"Memory not found"});const W=o=>o.filter(t=>!Q.includes(t.url)).map(t=>({...t,caption:X[t.url]||t.caption})),H=[...W(s.photos||[]),...v],R=[...W(s.videos||[]),...b];return e.jsxs(ue,{children:[e.jsxs("div",{style:i.page,children:[e.jsx(je,{isOpen:!!r,mediaSrc:r==null?void 0:r.url,type:r==null?void 0:r.type,caption:r==null?void 0:r.caption,onClose:se}),e.jsx(be,{isOpen:ee,onClose:()=>y(!1),onSave:ae,initialCaption:d==null?void 0:d.caption,title:"Edit Caption"}),e.jsx(Ce,{isOpen:p.isOpen,title:p.title,message:p.message,onConfirm:p.onConfirm,onCancel:()=>g(o=>({...o,isOpen:!1})),isDangerous:p.isDangerous,confirmText:"Delete"}),e.jsxs("div",{className:"container",children:[e.jsxs(le,{to:"/",style:i.backLink,children:[e.jsx(Se,{size:24})," ",e.jsx("span",{style:{marginLeft:"0.5rem"},children:"Back to Gallery"})]}),e.jsxs("div",{style:i.header,children:[e.jsx(l.div,{style:{...i.coverSection,y:ie,opacity:oe},children:e.jsxs("div",{style:i.coverImageWrapper,children:[e.jsx("img",{src:Z||s.cover,alt:s.title,style:{...i.coverImage,..._}}),e.jsx("div",{style:i.coverOverlay})]})}),e.jsxs(l.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.8},style:i.infoCard,className:"glass-panel",children:[e.jsx("h1",{style:i.title,children:s.title}),e.jsx("div",{style:i.divider}),e.jsx("p",{style:i.description,children:s.description}),e.jsxs("div",{style:i.actionButtons,children:[e.jsxs("button",{onClick:()=>B("image"),style:i.actionBtn,disabled:u!==null,children:[u==="image"?e.jsx("span",{className:"loader",style:{width:16,height:16,border:"2px solid #d4af37",borderBottomColor:"transparent",borderRadius:"50%",display:"inline-block",animation:"rotation 1s linear infinite"}}):e.jsx($,{size:18}),e.jsx("span",{style:{marginLeft:"0.5rem"},children:"ADD PHOTO"})]}),e.jsxs("button",{onClick:()=>B("video"),style:i.actionBtn,disabled:u!==null,children:[u==="video"?e.jsx("span",{className:"loader",style:{width:16,height:16,border:"2px solid #d4af37",borderBottomColor:"transparent",borderRadius:"50%",display:"inline-block",animation:"rotation 1s linear infinite"}}):e.jsx(Y,{size:18}),e.jsx("span",{style:{marginLeft:"0.5rem"},children:"ADD VIDEO"})]})]})]})]}),e.jsxs(l.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},style:i.section,children:[e.jsxs("h2",{style:i.sectionTitle,children:[e.jsx("span",{style:i.titleIcon,children:e.jsx($,{size:24})}),"Captured Moments"]}),e.jsx(l.div,{variants:q,initial:"hidden",whileInView:"visible",viewport:{once:!0},style:i.grid,children:H.length>0?H.map((o,t)=>e.jsx(l.div,{variants:J,children:e.jsx(G,{item:o,type:"image",onClick:a=>V(a,"image"),onEdit:L,onDelete:A})},t)):e.jsx("p",{style:i.emptyText,children:"No photos yet."})})]}),e.jsxs(l.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},style:i.section,children:[e.jsxs("h2",{style:i.sectionTitle,children:[e.jsx("span",{style:i.titleIcon,children:e.jsx(Y,{size:24})}),"Video Memories"]}),e.jsx(l.div,{variants:q,initial:"hidden",whileInView:"visible",viewport:{once:!0},style:i.grid,children:R.length>0?R.map((o,t)=>e.jsx(l.div,{variants:J,children:e.jsx(G,{item:o,type:"video",onClick:a=>V(a,"video"),onEdit:L,onDelete:A})},t)):e.jsx("p",{style:i.emptyText,children:"No videos yet."})})]})]})]}),e.jsxs("div",{style:{position:"fixed",bottom:10,right:10,background:"rgba(0,0,0,0.8)",color:"#0f0",padding:"10px",borderRadius:"5px",fontSize:"12px",zIndex:9999,pointerEvents:"none"},children:[e.jsxs("p",{children:["Memory ID: ",s==null?void 0:s.id]}),e.jsxs("p",{children:["Photos: ",v.length]}),e.jsxs("p",{children:["Videos: ",b.length]}),P&&e.jsxs("p",{style:{color:"red"},children:["Error: ",P]})]})]})},i={page:{minHeight:"100vh",backgroundColor:"#030305",color:"#fff",padding:"2rem 0",backgroundImage:"radial-gradient(circle at 50% 0%, #1a1a1a 0%, #030305 70%)"},backLink:{display:"inline-flex",alignItems:"center",color:"#d4af37",textDecoration:"none",marginBottom:"3rem",fontSize:"1rem",textTransform:"uppercase",letterSpacing:"0.1em",opacity:.8,transition:"opacity 0.3s"},header:{display:"flex",flexDirection:"column",alignItems:"center",gap:"3rem",marginBottom:"6rem",position:"relative"},coverSection:{position:"relative",zIndex:1,width:"100%",maxWidth:"1200px"},coverImageWrapper:{width:"100%",height:"clamp(300px, 50vh, 500px)",borderRadius:"30px",overflow:"hidden",boxShadow:"0 20px 60px rgba(0,0,0,0.5)",position:"relative"},coverImage:{width:"100%",height:"100%",objectFit:"cover",filter:"contrast(1.1) saturate(1.1)"},coverOverlay:{position:"absolute",inset:0,background:"linear-gradient(to bottom, transparent 0%, rgba(3,3,5,0.5) 100%)",pointerEvents:"none"},infoCard:{maxWidth:"900px",width:"90%",padding:"3rem",borderRadius:"30px",textAlign:"center",marginTop:"-100px",zIndex:2},title:{fontSize:"clamp(2.5rem, 6vw, 4rem)",fontFamily:"'Cormorant Garamond', serif",color:"#fff",marginBottom:"1rem",textShadow:"0 0 30px rgba(255,255,255,0.1)"},divider:{width:"80px",height:"1px",background:"linear-gradient(90deg, transparent, #d4af37, transparent)",margin:"0 auto 2rem"},description:{fontSize:"1.2rem",lineHeight:"1.8",color:"#ccc",fontFamily:"'Outfit', sans-serif",fontWeight:300,marginBottom:"2.5rem",maxWidth:"800px",margin:"0 auto 2.5rem"},actionButtons:{display:"flex",gap:"1.5rem",justifyContent:"center",flexWrap:"wrap"},actionBtn:{display:"flex",alignItems:"center",gap:"0.8rem",padding:"0.8rem 2rem",backgroundColor:"rgba(212, 175, 55, 0.1)",border:"1px solid rgba(212, 175, 55, 0.3)",borderRadius:"50px",color:"#d4af37",cursor:"pointer",fontSize:"0.9rem",textTransform:"uppercase",letterSpacing:"0.1em",transition:"all 0.3s ease"},section:{marginBottom:"6rem"},sectionTitle:{fontSize:"2.5rem",fontFamily:"'Cormorant Garamond', serif",marginBottom:"3rem",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem"},titleIcon:{color:"#d4af37",display:"flex"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"2rem"},emptyText:{color:"#666",fontStyle:"italic",textAlign:"center",gridColumn:"1 / -1",padding:"2rem"}};export{Oe as default};
